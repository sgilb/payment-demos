{"version":3,"sources":["../../src/services/errors.js"],"names":["ApiTimeout","Object","setPrototypeOf","prototype","name","Error","AuthenticationError","message","http_code","ActionNotAllowed","NotFoundError","ErrorWithBody","error","body","ValidationError","TooManyRequestsError","BadGateway","ApiError","ValueError","determineError","err","type","json","undefined","then","data","errorJSON","status"],"mappings":"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","sourcesContent":["/* eslint-disable camelcase */\r\n/* eslint-disable max-classes-per-file */\r\n/**\r\n * Error raised for pre-api value validation\r\n *\r\n * @export\r\n * @class ApiTimeout\r\n * @extends {Error}\r\n */\r\nexport class ApiTimeout extends Error {\r\n    constructor() {\r\n        super('ApiTimeout');\r\n        Object.setPrototypeOf(this, new.target.prototype);\r\n        this.name = ApiTimeout.name;\r\n    }\r\n}\r\n\r\n/**\r\n * AuthenticationError\r\n *\r\n * @export\r\n * @class AuthenticationError\r\n * @extends {Error}\r\n */\r\nexport class AuthenticationError extends Error {\r\n    constructor(message) {\r\n        AuthenticationError.http_code = 401;\r\n        super(message);\r\n        Object.setPrototypeOf(this, new.target.prototype);\r\n        this.name = AuthenticationError.name;\r\n    }\r\n}\r\n\r\n/**\r\n * ActionNotAllowed\r\n *\r\n * @export\r\n * @class AuthenticationError\r\n * @extends {Error}\r\n */\r\nexport class ActionNotAllowed extends Error {\r\n    constructor(message = 'ActionNotAllowed') {\r\n        ActionNotAllowed.http_code = 403;\r\n        super(message);\r\n        Object.setPrototypeOf(this, new.target.prototype);\r\n        this.name = ActionNotAllowed.name;\r\n    }\r\n}\r\n\r\n/**\r\n * UrlAlreadyRegistered\r\n *\r\n * @export\r\n * @class UrlAlreadyRegistered\r\n * @extends {Error}\r\n */\r\n// export class UrlAlreadyRegistered extends Error {\r\n//     constructor(message = 'UrlAlreadyRegistered') {\r\n//         UrlAlreadyRegistered.http_code = 409;\r\n//         super(message);\r\n//         Object.setPrototypeOf(this, new.target.prototype);\r\n//         this.name = UrlAlreadyRegistered.name;\r\n//     }\r\n// }\r\n\r\n/**\r\n * NotFoundError\r\n *\r\n * @export\r\n * @class AuthenticationError\r\n * @extends {Error}\r\n */\r\nexport class NotFoundError extends Error {\r\n    constructor(message = 'NotFoundError') {\r\n        NotFoundError.http_code = 404;\r\n        super(message);\r\n        Object.setPrototypeOf(this, new.target.prototype);\r\n        this.name = NotFoundError.name;\r\n    }\r\n}\r\n\r\n/**\r\n * UnprocessableError\r\n *\r\n * @export\r\n * @class UnprocessableError\r\n * @extends {Error}\r\n */\r\n// export class UnprocessableError extends Error {\r\n//     constructor(message = 'UnprocessableError') {\r\n//         UnprocessableError.http_code = 400;\r\n//         super(message);\r\n//         Object.setPrototypeOf(this, new.target.prototype);\r\n//         this.name = UnprocessableError.name;\r\n//     }\r\n// }\r\n\r\n/**\r\n * ValidationError\r\n *\r\n * @export\r\n * @class ValidationError\r\n * @extends {Error}\r\n */\r\nexport class ErrorWithBody extends Error {\r\n    constructor(http_code, error, message) {\r\n        super(message);\r\n        Object.setPrototypeOf(this, new.target.prototype);\r\n        ErrorWithBody.http_code = http_code;\r\n        this.body = error;\r\n    }\r\n}\r\n\r\n/**\r\n * ValidationError\r\n *\r\n * @export\r\n * @class ValidationError\r\n * @extends {Error}\r\n */\r\nexport class ValidationError extends ErrorWithBody {\r\n    constructor(error, message = 'ValidationError') {\r\n        super(422, error, message);\r\n    }\r\n}\r\n\r\n/**\r\n * TooManyRequestsError\r\n *\r\n * @export\r\n * @class TooManyRequestsError\r\n * @extends {Error}\r\n */\r\nexport class TooManyRequestsError extends ErrorWithBody {\r\n    constructor(error, message = 'TooManyRequestsError') {\r\n        super(429, error, message);\r\n    }\r\n}\r\n\r\n/**\r\n * BadGateway\r\n *\r\n * @export\r\n * @class BadGateway\r\n * @extends {Error}\r\n */\r\nexport class BadGateway extends Error {\r\n    constructor() {\r\n        super('Bad gateway');\r\n        BadGateway.http_code = 502;\r\n        Object.setPrototypeOf(this, new.target.prototype);\r\n    }\r\n}\r\n\r\n/**\r\n * ApiError\r\n *\r\n * @export\r\n * @class HttpError\r\n * @extends {Error}\r\n */\r\nexport class ApiError extends Error {\r\n    constructor(error) {\r\n        super('API Error');\r\n        Object.setPrototypeOf(this, new.target.prototype);\r\n        this.name = 'API Error';\r\n        this.body = error;\r\n    }\r\n}\r\n\r\n/**\r\n * AuthenticationError\r\n *\r\n * @export\r\n * @class ValueError\r\n * @extends {Error}\r\n */\r\nexport class ValueError extends Error {\r\n    constructor(message) {\r\n        super(message);\r\n        Object.setPrototypeOf(this, new.target.prototype);\r\n        this.name = ValueError.name;\r\n        this.body = message;\r\n    }\r\n}\r\n\r\nexport const determineError = async err => {\r\n    // Fot time outs\r\n    if (err.type === 'request-timeout') {\r\n        return new ApiTimeout();\r\n    }\r\n\r\n    if (err instanceof ValueError) {\r\n        throw err;\r\n    }\r\n\r\n    // For 'no body' response, replace with empty object\r\n    const errorJSON =\r\n        err.json !== undefined\r\n            ? await err.json.then(data => {\r\n                  return data;\r\n              })\r\n            : {};\r\n\r\n    switch (err.status) {\r\n        case 401:\r\n            return new AuthenticationError();\r\n        case 404:\r\n            return new NotFoundError();\r\n        case 403:\r\n            return new ActionNotAllowed();\r\n        case 422:\r\n            return new ValidationError(await errorJSON);\r\n        case 429:\r\n            return new TooManyRequestsError(await errorJSON);\r\n        case 502:\r\n            return new BadGateway();\r\n        default:\r\n            return new ApiError(await errorJSON);\r\n    }\r\n};\r\n"],"file":"errors.js"}